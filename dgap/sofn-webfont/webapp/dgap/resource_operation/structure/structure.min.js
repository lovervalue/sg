webpackJsonp([1],{846:function(e,exports,t){e.exports=t(847)},847:function(e,exports,t){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(exports,"__esModule",{value:!0});var u=t(145),r=a(u),s=t(161),o=a(s),d=t(183),c=a(d),f=t(848),h=a(f),p=t(101),m=a(p),y=t(88),g=a(y),v=t(143),b=a(v),k=t(123),E=a(k),C=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var l in a)Object.prototype.hasOwnProperty.call(a,l)&&(e[l]=a[l])}return e},S=function(){function e(e,t){for(var a=0;a<t.length;a++){var l=t[a];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(e,l.key,l)}}return function(t,a,l){return a&&e(t.prototype,a),l&&e(t,l),t}}();t(184),t(185),t(104),t(851),t(124),t(105),t(221),t(125);var w=t(1),x=a(w),O=t(187),R=a(O),j=t(106),M=t(215),_=(a(M),t(216)),I=t(222),F=a(I),K=m.default.Option,N=function(e){e="string"==typeof e?e:"操作成功",E.default.success(e,1)},T=function(e){e="string"==typeof e?e:"操作失败",E.default.error(e)},P=function(){var e=E.default.loading("处理中...",0);setTimeout(function(){e(),N()},1500)},B=(function(e){function t(){return l(this,t),n(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}i(t,e),S(t,[{key:"render",value:function(){var e=this.props.openField;return x.default.createElement("div",null,x.default.createElement("a",{href:"#",style:{marginRight:10},onClick:e},"修改"),x.default.createElement("a",{href:"#",style:{marginRight:10},onClick:P},"删除"))}}])}(w.Component),function(e){function t(e){l(this,t);var a=n(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.state={trees:[],breads:[{name:"数据共享系统",link:"/#/index/content/dgap/resource/resourceDir"},{name:"资源目录管理",link:"/#/index/content/dgap/resource/resourceMa"},{name:"查看表结构"}],viewButton:{loading:!1},exampleModal:{visible:!1},publishModal:{visible:!1},publishForm:{name:{type:"input"},directoryId:{type:"select",options:[]},flag:{value:!0},description:{type:"textarea"}},tableName:{type:"input"},table:{loading:!1,selectedRowKeys:[],isSearchRowKeys:[],dataSource:[],columns:[{title:"中文字段名",dataIndex:"chineseName"},{title:"英文字段名",dataIndex:"englishName"},{title:"字段类型",dataIndex:"cnFileType"},{title:"字段长度",dataIndex:"len"},{title:"是否可作为查询条件",dataIndex:"ISSEARCH",render:function(e,t,l){return x.default.createElement(b.default,{defaultChecked:!1,checked:!!~a.state.table.isSearchRowKeys.indexOf(t.id),onChange:function(e){var l=e.target.checked,n=C({},a.state.table);if(l){var i=n.selectedRowKeys.indexOf(t.id);~i?n.selectedRowKeys[i]=t.id:n.selectedRowKeys[n.selectedRowKeys.length]=t.id}var u=n.isSearchRowKeys.indexOf(t.id);l?~u?n.isSearchRowKeys[u]=t.id:n.isSearchRowKeys[n.isSearchRowKeys.length]=t.id:~u&&n.isSearchRowKeys.splice(u,1),a.setState({table:n})}})}}]},exampleTable:{dataSource:[],columns:[]}},a}return i(t,e),S(t,[{key:"updateState",value:function(e){var t=this,a=e?e.split("."):[];return function(e){for(var l=Object.assign({},t.state),n=l,i=0,u=a.length;i<u;i++)n=n[a[i]];Object.assign(n,e),t.setState(Object.assign({},t.state,l),function(){})}}},{key:"onChange",value:function(e){var t=this,a=e.split(".");return function(e){for(var l=Object.assign({},t.state),n=l,i=null,u=0,r=a.length;u<r;u++)n=n[a[u]];switch(n.type){case"input":case"textarea":n.value=e.target.value,i=Object.assign({},l);break;default:n.value=e,i=Object.assign({},l)}t.setState(Object.assign({},t.state,i),function(){})}}},{key:"showModal",value:function(e,t){var a=this,l=this.state;return function(){l[e].visible=t,a.setState(Object.assign({},a.state,l),function(){})}}},{key:"fetchFields",value:function(){var e=this,t=this.state,a=t.tableId,l=t.table;l.loading=!0,this.setState({table:l}),j.Api.getFields({tableId:a}).then(function(t){l.loading=!1,l.dataSource=t,e.setState({table:l})})}},{key:"fetchTrees",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";j.Api.getTables({tableName:t}).then(function(t){e.setState({trees:t})})}},{key:"fetchExample",value:function(){var e=this,t=this.state,a=t.tableId,l=t.viewButton;l.loading=!0,this.setState({viewButton:l}),j.Api.getPage({pageSize:3,pageNum:1,tableId:a}).then(function(t){var a=t.fields,n=t.table;l.loading=!1,e.setState({viewButton:l}),e.updateState("exampleTable")({dataSource:n,columns:a}),e.showModal("exampleModal",!0)()})}},{key:"fetchResourceDir",value:function(){var e=this;j.Api.getResourceDir().then(function(t){var a=e.state.publishForm;a.directoryId.options=t,a.directoryId.value=t.length?t[0].id:"",e.setState({publishForm:a})})}},{key:"submitResource",value:function(){var e=this,t=this.state,a=t.publishForm,l=t.table,n=l.selectedRowKeys,i=l.isSearchRowKeys,u={name:a.name.value,directoryId:a.directoryId.value,description:a.description.value,flag:a.flag.value?"A":"N",publishFields:n.join(","),conditionFields:i.join(",")};this.updateState("publishModal")({confirmLoading:!0}),j.Api.configResource(u).then(function(t){e.updateState("publishModal")({confirmLoading:!1,visible:!1}),N()},function(t){e.updateState("publishModal")({confirmLoading:!1})})}},{key:"onSelectChange",value:function(e,t){var a=C({},this.state.table),l=a.isSearchRowKeys.filter(function(t,a){return~e.indexOf(t)});a.selectedRowKeys=e,a.isSearchRowKeys=l,this.setState({table:a})}},{key:"search",value:function(){var e=this.state.tableName;if(null!=e.value&&e.value.length>50)return void T("搜索条件不能超过50个字符");this.fetchTrees(e.value)}},{key:"onSelectTree",value:function(e,t){var a=this,l=t.selected,n=e[0];!l||n<=0||this.setState({tableId:n},function(){return a.fetchFields()})}},{key:"onChangeSwitch",value:function(e){this.updateState("publishForm.flag")({value:e})}},{key:"validPublishForm",value:function(){var e=this.state.publishForm,t=e.name,a=e.description,l=e.directoryId;return null==t.value||t.value.length<=0?void T("请输入资源名称"):t.value.length>30?void T("资源名称长度不能超过30个字符"):null==l.value?void T("请选取资源目录"):null!=a.value&&/^[\u4E00-\u9FA5\uF900-\uFA2D_a-z0-9-\s]+$/i.test(a.value)?!(a.value.length>300)||void T("资源描述长度不能超过300个字符"):void T("请输入资源描述")}},{key:"publish",value:function(){this.validPublishForm()&&this.submitResource()}},{key:"componentWillMount",value:function(){}},{key:"componentDidMount",value:function(){this.fetchTrees(),this.fetchResourceDir()}},{key:"render",value:function(){var e=this.state,t=e.exampleModal,a=e.publishModal,l=e.table,n=e.exampleTable,i=e.trees,u=e.breads,s=e.tableName,d=e.publishForm,f=e.tableId,p=e.viewButton,y={selectedRowKeys:l.selectedRowKeys,onChange:this.onSelectChange.bind(this)};return x.default.createElement("div",null,x.default.createElement(r.default,null,x.default.createElement(o.default,{span:24},x.default.createElement(F.default,null))),x.default.createElement(r.default,{justify:"center"},x.default.createElement(o.default,{span:4},x.default.createElement(_.SgMenu,null)),x.default.createElement(o.default,{span:20,style:{borderLeft:"1px solid #e9e9e9",backgroundColor:"#FFF",borderRadius:5}},x.default.createElement("div",{style:{marginBottom:16,marginTop:12}},x.default.createElement(r.default,{type:"flex",justify:"center",align:"middle"},x.default.createElement(o.default,{span:23},x.default.createElement(_.SgBreadcrumb,{breads:u})))),x.default.createElement("div",{style:{marginBottom:16}},x.default.createElement(r.default,{type:"flex",justify:"center",align:"middle"},x.default.createElement(o.default,{span:18},x.default.createElement("span",{style:{marginRight:10}},"仓库表"),x.default.createElement(c.default,{placeholder:"仓库表名",value:s.value,onChange:this.onChange("tableName"),style:{width:105,marginRight:10}}),x.default.createElement(g.default,{type:"primary",onClick:this.search.bind(this)},"查询")),x.default.createElement(o.default,{span:5,style:{textAlign:"right"}},x.default.createElement("div",{style:{marginRight:10}}),x.default.createElement(g.default,C({type:"primary",disabled:null==f},p,{onClick:this.fetchExample.bind(this)}),"查看仓库表数据")))),x.default.createElement(r.default,{type:"flex",justify:"center"},x.default.createElement(o.default,{span:5},x.default.createElement("div",null,x.default.createElement(_.SgTree,{onSelect:this.onSelectTree.bind(this),trees:i}))),x.default.createElement(o.default,{span:19,style:{marginBottom:15}},x.default.createElement(_.SgTable,C({pagination:!1,rowSelection:y},l)))),x.default.createElement(r.default,{type:"flex",justify:"center"},x.default.createElement(o.default,null,x.default.createElement(g.default,{type:"primary",size:"large",style:{marginBottom:50},disabled:l.selectedRowKeys.length<=0,onClick:this.showModal.call(this,"publishModal",!0)},"发布成资源"))))),x.default.createElement(_.SgModal,C({title:"仓库表",updateState:this.updateState("exampleModal")},t,{footer:[x.default.createElement(g.default,C({key:"submit",type:"primary",size:"large"},t.confirmButton,{onClick:this.showModal.call(this,"exampleModal",!1)}),"保存")]}),x.default.createElement("div",null,x.default.createElement(r.default,{style:{marginBottom:10},type:"flex",justify:"center",align:"middle"},x.default.createElement(o.default,{span:19},x.default.createElement(_.SgTable,C({},n,{pagination:!1,bordered:!0,size:"small",rowKey:function(e,t){return t}})))))),x.default.createElement(_.SgModal,C({title:"资源发布",updateState:this.updateState.call(this,"publishModal"),onOk:this.publish.bind(this)},a),x.default.createElement("div",null,x.default.createElement(r.default,{style:{marginBottom:10},type:"flex",justify:"center",align:"middle"},x.default.createElement(o.default,{span:4},x.default.createElement("span",null,"资源名称")),x.default.createElement(o.default,{span:16},x.default.createElement(c.default,{placeholder:"资源名称",onChange:this.onChange("publishForm.name")}))),x.default.createElement(r.default,{style:{marginBottom:10},type:"flex",justify:"center",align:"middle"},x.default.createElement(o.default,{span:4},x.default.createElement("span",null,"资源目录")),x.default.createElement(o.default,{span:16},x.default.createElement(m.default,{defaultValue:d.directoryId.value,style:{width:"100%"},value:d.directoryId.value,onChange:this.onChange.call(this,"publishForm.directoryId")},d.directoryId.options.map(function(e,t){return x.default.createElement(K,{value:e.id,key:t},e.name)})))),x.default.createElement(r.default,{style:{marginBottom:10},type:"flex",justify:"center",align:"middle"},x.default.createElement(o.default,{span:4},x.default.createElement("span",null,"是否启用")),x.default.createElement(o.default,{span:16},x.default.createElement(h.default,{checkedChildren:"启用",unCheckedChildren:"禁用",defaultChecked:d.flag.value,onChange:this.onChangeSwitch.bind(this)}))),x.default.createElement(r.default,{style:{marginBottom:10},type:"flex",justify:"center",align:"middle"},x.default.createElement(o.default,{span:4},x.default.createElement("span",null,"资源描述")),x.default.createElement(o.default,{span:16},x.default.createElement(c.default,{type:"textarea",rows:4,placeholder:"资源描述",onChange:this.onChange("publishForm.description")}))))))}}]),t}(w.Component));exports.default=B,R.default.value("PageView",B)},848:function(e,exports,t){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(exports,"__esModule",{value:!0});var l=t(3),n=a(l),i=t(12),u=a(i),r=t(2),s=a(r),o=t(6),d=a(o),c=t(4),f=a(c),h=t(5),p=a(h),m=t(1),y=a(m),g=t(7),v=a(g),b=t(849),k=a(b),E=t(9),C=a(E),S=function(e){function t(){return(0,s.default)(this,t),(0,f.default)(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return(0,p.default)(t,e),(0,d.default)(t,[{key:"render",value:function(){var e=this.props,t=e.prefixCls,a=e.size,l=e.className,i=void 0===l?"":l,r=(0,C.default)(i,(0,u.default)({},t+"-small","small"===a));return y.default.createElement(k.default,(0,n.default)({},this.props,{className:r}))}}]),t}(y.default.Component);exports.default=S,S.defaultProps={prefixCls:"ant-switch"},S.propTypes={prefixCls:v.default.string,size:v.default.oneOf(["small","default","large"]),className:v.default.string},e.exports=exports.default},849:function(e,exports,t){e.exports=t(850)},850:function(e,t,a){"use strict";function l(){}Object.defineProperty(t,"__esModule",{value:!0});var n=a(3),i=a.n(n),u=a(12),r=a.n(u),s=a(64),o=a.n(s),d=a(2),c=a.n(d),f=a(6),h=a.n(f),p=a(4),m=a.n(p),y=a(5),g=a.n(y),v=a(1),b=a.n(v),k=a(7),E=a.n(k),C=a(9),S=function(e){function t(e){c()(this,t);var a=m()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));w.call(a);var l=!1;return l="checked"in e?!!e.checked:!!e.defaultChecked,a.state={checked:l},a}return g()(t,e),h()(t,[{key:"componentWillReceiveProps",value:function(e){"checked"in e&&this.setState({checked:!!e.checked})}},{key:"setChecked",value:function(e){this.props.disabled||("checked"in this.props||this.setState({checked:e}),this.props.onChange(e))}},{key:"render",value:function(){var e,t=this.props,a=t.className,l=t.prefixCls,n=t.disabled,u=t.checkedChildren,s=t.tabIndex,d=t.unCheckedChildren,c=o()(t,["className","prefixCls","disabled","checkedChildren","tabIndex","unCheckedChildren"]),f=this.state.checked,h=n?-1:s||0,p=C((e={},r()(e,a,!!a),r()(e,l,!0),r()(e,l+"-checked",f),r()(e,l+"-disabled",n),e));return b.a.createElement("span",i()({},c,{className:p,tabIndex:h,ref:this.saveNode,onKeyDown:this.handleKeyDown,onClick:this.toggle,onMouseUp:this.handleMouseUp}),b.a.createElement("span",{className:l+"-inner"},f?u:d))}}]),t}(v.Component),w=function(){var e=this;this.toggle=function(){var t=e.props.onClick,a=!e.state.checked;e.setChecked(a),t(a)},this.handleKeyDown=function(t){37===t.keyCode?e.setChecked(!1):39===t.keyCode?e.setChecked(!0):32!==t.keyCode&&13!==t.keyCode||e.toggle()},this.handleMouseUp=function(t){e.node&&e.node.blur(),e.props.onMouseUp&&e.props.onMouseUp(t)},this.saveNode=function(t){e.node=t}};S.propTypes={className:E.a.string,prefixCls:E.a.string,disabled:E.a.bool,checkedChildren:E.a.any,unCheckedChildren:E.a.any,onChange:E.a.func,onMouseUp:E.a.func,onClick:E.a.func,tabIndex:E.a.number,checked:E.a.bool,defaultChecked:E.a.bool},S.defaultProps={prefixCls:"rc-switch",checkedChildren:null,unCheckedChildren:null,className:"",defaultChecked:!1,onChange:l,onClick:l},t.default=S},851:function(e,exports,t){"use strict";t(21),t(852)},852:function(e,exports){}},[846]);